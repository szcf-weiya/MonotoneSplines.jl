<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · MonotoneSplines.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MonotoneSplines.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/monofit/">Monotone Fitting</a></li><li><a class="tocitem" href="../examples/monofit_mlp/">MLP Generator (fitting curve)</a></li><li><a class="tocitem" href="../examples/monoci_mlp/">MLP Generator (confidence band)</a></li><li><a class="tocitem" href="../examples/diff_sort/">Differentiable Sort</a></li></ul></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/master/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.Spl" href="#MonotoneSplines.Spl"><code>MonotoneSplines.Spl</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A <code>Spl</code> object.</p><p><strong>Fields</strong></p><ul><li><code>H</code>: an <code>RObject</code> generated by <code>splines::bs()</code></li><li><code>β</code>: the coefficients for the B-spline.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/mono_spl.jl#L11-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.aug-Tuple{AbstractFloat}" href="#MonotoneSplines.aug-Tuple{AbstractFloat}"><code>MonotoneSplines.aug</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">aug(λ::AbstractFloat)</code></pre><p>Augment <code>λ</code> with 8 different functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/boot.jl#L351-L355">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.build_model-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T&lt;:AbstractFloat" href="#MonotoneSplines.build_model-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T&lt;:AbstractFloat"><code>MonotoneSplines.build_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">build_model(x::AbstractVector{T}; λ, t)</code></pre><p>(deprecated) An unified function for constructing design matrix and other internal variables. It is cubic spline if both smoothness parameter <code>λ</code> and its corresponding threshold <code>t</code> are nothing, otherwise it is smoothing spline.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/utils.jl#L209-L213">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.build_model-Union{Tuple{T}, Tuple{AbstractVector{T}, Bool}} where T&lt;:AbstractFloat" href="#MonotoneSplines.build_model-Union{Tuple{T}, Tuple{AbstractVector{T}, Bool}} where T&lt;:AbstractFloat"><code>MonotoneSplines.build_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">build_model(x::AbstractVector{T}, scaled::Bool; &lt;keyword arguments&gt;)</code></pre><p>Construct design matrix and other internal variables for smoothing spline. If <code>scaled</code>, <code>x</code> is scaled to <code>[0, 1]</code>.</p><p><strong>Arguments</strong></p><ul><li><code>xboundary = nothing</code>: the boundary of <code>x</code>, if <code>nothing</code>, set it to be <code>[min_x, max_x]</code>.</li><li><code>xnew = nothing</code>: evaluate B-spline design matrix on <code>xnew</code> if not nothing.</li><li><code>all_knots = false</code>: whether to use all knots. If <code>false</code>, use the same rule as in R&#39;s <code>smooth.spline</code>.</li><li><code>prop_nknots = 1.0</code>: a proportion for using fewer knots. Suppose the number of knots is <code>nknots</code>, then the final number of knots is <code>prop_nknots</code> * <code>nknots</code>. Currently, it is only effective when <code>all_knots = false</code>.</li><li><code>ε = 6.06e-6</code>: a small number added to the diagonal of matrix Ω to ensure it is positive definite.</li></ul><p><strong>Returns</strong></p><ul><li>B-spline design matrix <code>B</code> at <code>x</code> for cubic splines</li><li><code>Bnew</code> at new points <code>xnew</code> if it is not <code>nothing</code></li><li><code>L = nothing</code>: keep same return list for model of smoothing splines</li><li><code>J</code>: number of basis functions, which does not change for cubic splines, so it is only intended for smoothing splines </li></ul><p>the above four are shared with the method for cubic splines, but for smoothing splines, it also returns </p><ul><li><code>mx, rx, idx, idx0</code>: only for smoothing splines</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/utils.jl#L141-L164">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.build_model-Union{Tuple{T}, Tuple{AbstractVector{T}, Int64}} where T&lt;:AbstractFloat" href="#MonotoneSplines.build_model-Union{Tuple{T}, Tuple{AbstractVector{T}, Int64}} where T&lt;:AbstractFloat"><code>MonotoneSplines.build_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">build_model(x::AbstractVector{T}, J::Int; &lt;keyword arguments&gt;)</code></pre><p>Construct design matrix and other internal variables for cubic spline with <code>J</code> basis functions.</p><p><strong>Arguments</strong></p><ul><li><code>xboundary = nothing</code>: the boundary of <code>x</code>, if <code>nothing</code>, set it to be <code>[min_x, max_x]</code>.</li><li><code>xnew = nothing</code>: evaluate B-spline design matrix on <code>xnew</code> if not nothing.</li></ul><p><strong>Returns</strong></p><ul><li>B-spline design matrix <code>B</code> at <code>x</code> for cubic splines</li><li><code>Bnew</code> at new points <code>xnew</code> if it is not <code>nothing</code></li><li><code>L = nothing</code>: keep same return list for model of smoothing splines</li><li><code>J</code>: number of basis functions, which does not change for cubic splines, so it is only intended for smoothing splines </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/utils.jl#L109-L125">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.check_CI-Tuple{}" href="#MonotoneSplines.check_CI-Tuple{}"><code>MonotoneSplines.check_CI</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_CI(; &lt;keyword arguments&gt;)</code></pre><p>Conduct repeated experiments to check the overlap of confidence bands (default, <code>check_acc = false</code>) or accuracy of fitting curves (<code>check_acc = true</code>) between MLP generator and OPT solution. </p><p><strong>Arguments</strong></p><ul><li><code>n = 100</code>: sample size</li><li><code>σ = 0.1</code>: noise level</li><li><code>f::Function = exp</code>: the truth curve</li><li><code>seed = 1234</code>: random seed for the simulated data</li><li><code>check_acc = false</code>: check overlap of confidence bands (default: false) or accuracy of fitting curves (true)</li><li><code>nepoch0 = 5</code>: number of epoch in the first step to fit the curve</li><li><code>nepoch = 50</code>: number of epoch in the second step to obtain the confidence band</li><li><code>niter_per_epoch = 100</code>: number of iterations in each epoch</li><li><code>η0 = 1e-4</code>: learning rate in step 1</li><li><code>η = 1e-4</code>: learning rate in step 2 (NOTE: lr did not make much difference, unify these two)</li><li><code>K0 = 32</code>: Monte Carlo size for averaging <code>λ</code> in step 2</li><li><code>K = 32</code>: Monte Carlo size for averaging <code>λ</code> in step 1 and for averaging <code>y</code> in step 2. (NOTE: unify these two Monte Carlo size)</li><li><code>nB = 2000</code>: number of bootstrap replications</li><li><code>nrep = 5</code>: number of repeated experiments</li><li><code>fig = true</code>: whether to plot</li><li><code>figfolder = ~</code>: folder for saving the figures if <code>fig = true</code></li><li><code>λs = exp.(range(-8, -2, length = 10))</code>: region of continuous <code>λ</code></li><li><code>nhidden = 1000</code>: number of hidden layers</li><li><code>depth = 2</code>: depth of MLP</li><li><code>demo = false</code>: whether to save internal results for demo purpose</li><li><code>model_file = nothing</code>: if not nothing, load the model from the file.</li><li><code>gpu_id = 0</code>: specify the id of GPU, -1 for CPU.</li><li><code>prop_nknots = 0.2</code>: proportion of number of knots in B-spline basis. </li><li><code>method = &quot;lambda&quot;</code>: train MLP generator with PyTorch; if <code>jl_lambda</code>, train with Flux; if <code>lambda_from_file</code>, load model from file. (NOTE: rename to backend keyword)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/boot.jl#L24-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.ci_mono_ss_mlp-Union{Tuple{T}, Tuple{AbstractVector{T}, AbstractVector{T}, AbstractVector{T}}} where T&lt;:AbstractFloat" href="#MonotoneSplines.ci_mono_ss_mlp-Union{Tuple{T}, Tuple{AbstractVector{T}, AbstractVector{T}, AbstractVector{T}}} where T&lt;:AbstractFloat"><code>MonotoneSplines.ci_mono_ss_mlp</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ci_mono_ss_mlp(x::AbstractVector{T}, y::AbstractVector{T}, λs::AbstractVector{T}; )</code></pre><p>Fit data <code>x, y</code> at each <code>λs</code> with confidence bands.</p><p><strong>Arguments</strong></p><ul><li><code>prop_nknots = 0.2</code>: proportion of number of knots</li><li><code>backend = &quot;flux&quot;</code>: <code>flux</code> or <code>pytorch</code></li><li><code>model_file</code>: path for saving trained model</li><li><code>nepoch0 = 3</code>: number of epoch in training step 1</li><li><code>nepoch = 3</code>: number of epoch in training step 2</li><li><code>niter_per_epoch = 100</code>: number of iterations in each epoch</li><li><code>M = 10</code>: Monte Carlo size</li><li><code>nhidden = 100</code>: number of hidden units</li><li><code>disable_progressbar = false</code>: set true if generating documentation</li><li><code>device = :cpu</code>: train using <code>:cpu</code> or <code>:gpu</code></li><li><code>sort_in_nn = true</code>: (only for backend = &quot;flux&quot;) whether put <code>sort</code> in <code>MLP</code> </li><li><code>eval_in_batch = false</code>: (only for backend = &quot;flux&quot;) Currently, <code>Flux</code> does not support <code>sort</code> in batch mode. A workaround with customized <code>Zygote.batch_sort</code> needs further verifications. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/boot.jl#L534-L553">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.conf_band_width-Tuple{AbstractMatrix}" href="#MonotoneSplines.conf_band_width-Tuple{AbstractMatrix}"><code>MonotoneSplines.conf_band_width</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">conf_band_width(CIs::AbstractMatrix)</code></pre><p>Calculate width of confidence bands.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/utils.jl#L98-L102">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.coverage_prob-Tuple{AbstractMatrix, AbstractVector}" href="#MonotoneSplines.coverage_prob-Tuple{AbstractMatrix, AbstractVector}"><code>MonotoneSplines.coverage_prob</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">coverage_prob(CIs::AbstractMatrix, y0::AbstractVector)</code></pre><p>Calculate coverage probability given <code>n x 2</code> CI matrix <code>CIs</code> and true vector <code>y0</code> of size <code>n</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/utils.jl#L87-L91">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.cv_mono_ss-Union{Tuple{T}, Tuple{AbstractVector{T}, AbstractVector{T}}, Tuple{AbstractVector{T}, AbstractVector{T}, Any}} where T&lt;:AbstractFloat" href="#MonotoneSplines.cv_mono_ss-Union{Tuple{T}, Tuple{AbstractVector{T}, AbstractVector{T}}, Tuple{AbstractVector{T}, AbstractVector{T}, Any}} where T&lt;:AbstractFloat"><code>MonotoneSplines.cv_mono_ss</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cv_mono_ss(x::AbstractVector{T}, y::AbstractVector{T}, λs::AbstractVector{T})</code></pre><p>Cross-validation for monotone fitting with smoothing spline on <code>y ~ x</code> among parameters <code>λs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/mono_spl.jl#L188-L192">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.div_into_folds-Tuple{Int64}" href="#MonotoneSplines.div_into_folds-Tuple{Int64}"><code>MonotoneSplines.div_into_folds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">div_into_folds(N::Int; K = 10, seed = 1234)</code></pre><p>Equally divide <code>1:N</code> into <code>K</code> folds with random seed <code>seed</code>. If <code>seed</code> is negative, it is a non-random division, where the <code>i</code>-th fold would be the <code>i</code>-th equidistant range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/utils.jl#L27-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.eval_penalty-Union{Tuple{T}, Tuple{MonotoneSplines.Spl{T}, AbstractVector{T}}} where T&lt;:AbstractFloat" href="#MonotoneSplines.eval_penalty-Union{Tuple{T}, Tuple{MonotoneSplines.Spl{T}, AbstractVector{T}}} where T&lt;:AbstractFloat"><code>MonotoneSplines.eval_penalty</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">eval_penalty(model::Spl{T}, x::AbstractVector{T})</code></pre><p>Evaluate the penalty matrix by R&#39;s <code>fda::eval.penalty</code>. To make sure the corresponding design matrix contructed by <code>fda::eval.basis</code> is the same as <code>model.H</code>, it asserts the norm difference should be smaller than <code>sqrt(eps())</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/mono_spl.jl#L117-L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.fit" href="#MonotoneSplines.fit"><code>MonotoneSplines.fit</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fit(X, y, paras, method)</code></pre><p><code>paras</code> is either the number of basis functions, or the sequence of interior knots. Return a <code>Spl</code> object.</p><pre><code class="language-julia hljs">n = 100
x = rand(n) * 2 .- 1
y = x .^3 + randn(n) * 0.01
res = fit(x, y, 10, &quot;monotone&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/mono_spl.jl#L32-L43">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.gen_data-Tuple{Int64, Real, Function}" href="#MonotoneSplines.gen_data-Tuple{Int64, Real, Function}"><code>MonotoneSplines.gen_data</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gen_data(n, σ, f::Union{Function, String}; xmin = -1, xmax = 1, k = 10)</code></pre><p>Generate <code>n</code> data points <code>(xi, yi)</code> from curve <code>f</code> with noise level <code>σ</code>, i.e., <code>yi = f(xi) + N(0, σ^2)</code>.</p><p>It returns four vectors, <code>x, y, x0, y0</code>, where</p><ul><li><code>x, y</code>: pair points of length <code>n</code>.</li><li><code>x0, y0</code>: true curve without noise, represented by <code>k*n</code> points.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/utils.jl#L5-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.jaccard_index-Tuple{AbstractVector, AbstractVector}" href="#MonotoneSplines.jaccard_index-Tuple{AbstractVector, AbstractVector}"><code>MonotoneSplines.jaccard_index</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">jaccard_index(a::AbstractVector, b::AbstractVector)</code></pre><p>Calculate Jaccard Index for two confidence intervals <code>a</code> and <code>b</code></p><pre><code class="nohighlight hljs">jaccard_index(a::AbstractMatrix, b::AbstractMatrix)</code></pre><p>Calculate Jaccard Index for two confidence intervals <code>a[i, :]</code> and <code>b[i, :]</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/utils.jl#L224-L232">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.load_model-Tuple{Matrix, String}" href="#MonotoneSplines.load_model-Tuple{Matrix, String}"><code>MonotoneSplines.load_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_model(n::Int, J::Int, nhidden::Int, model_file::String; dim_lam = 8, gpu_id = 3)</code></pre><p>Load trained model from <code>model_file</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/boot.jl#L984-L988">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.mono_ss" href="#MonotoneSplines.mono_ss"><code>MonotoneSplines.mono_ss</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mono_ss(B::AbstractMatrix, y::AbstractVector, L::AbstractMatrix, J::Int, λ::AbstractFloat)</code></pre><p>Monotone Fitting with Smoothing Splines given design matrix <code>B</code> and cholesky-decomposed matrix <code>L</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/mono_spl.jl#L154-L158">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.mono_ss_mlp-Tuple{AbstractVector, AbstractVector}" href="#MonotoneSplines.mono_ss_mlp-Tuple{AbstractVector, AbstractVector}"><code>MonotoneSplines.mono_ss_mlp</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mono_ss_mlp(x::AbstractVector, y::AbstractVector; λl, λu)</code></pre><p>Fit monotone smoothing spline by training a MLP generator.</p><p><strong>Arguments</strong></p><ul><li><code>prop_nknots = 0.2</code>: proportion of number of knots</li><li><code>backend = flux</code>: use <code>flux</code> or <code>pytorch</code></li><li><code>device = :cpu</code>: use <code>:cpu</code> or <code>:gpu</code></li><li><code>nhidden = 100</code>: number of hidden units</li><li><code>disable_progressbar = false</code>: disable progressbar (useful in Documenter.jl)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/boot.jl#L502-L514">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.predict-Union{Tuple{T}, Tuple{MonotoneSplines.Spl{T}, AbstractVector{T}}} where T&lt;:AbstractFloat" href="#MonotoneSplines.predict-Union{Tuple{T}, Tuple{MonotoneSplines.Spl{T}, AbstractVector{T}}} where T&lt;:AbstractFloat"><code>MonotoneSplines.predict</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">predict(model::Spl{T}, xs::AbstractVector{T})
predict(X::Vector{Float64}, y::Vector{Float64}, J::Int, Xnew::AbstractVector{Float64}, ynew::AbstractVector{Float64}
predict(X::Vector{Float64}, y::Vector{Float64}, J::Int, Xnew::Vector{Float64}, ynew::Vector{Float64}, σ::Vector{Float64}</code></pre><p>Make prediction based on fitted <code>Spl</code> on new points <code>xs</code>. If <code>Xnew</code> is provided, then also returns the prediction error <code>‖yhat - ynew‖_2^2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/mono_spl.jl#L72-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.py_train_G_lambda-Tuple{AbstractVector, AbstractMatrix, AbstractMatrix}" href="#MonotoneSplines.py_train_G_lambda-Tuple{AbstractVector, AbstractMatrix, AbstractMatrix}"><code>MonotoneSplines.py_train_G_lambda</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">py_train_G_lambda(y::AbstractVector, B::AbstractMatrix, L::AbstractMatrix; &lt;keyword arguments&gt;)</code></pre><p>Wrapper for training MLP generator using PyTorch.</p><p><strong>Arguments</strong></p><ul><li><code>η0</code>, <code>η</code>: learning rate</li><li><code>K0</code>, <code>K</code>: Monte Carlo size</li><li><code>nepoch0</code>, <code>nepoch</code>: number of epoch</li><li><code>nhidden</code>, <code>depth</code>: size of MLP</li><li><code>λl</code>, <code>λu</code>: range of <code>λ</code></li><li><code>use_torchsort = false</code>: <code>torch.sort</code> (default: false) or <code>torchsort.soft_sort</code> (true)</li><li><code>sort_reg_strength = 0.1</code>: tuning parameter when <code>use_torchsort = true</code>.</li><li><code>model_file</code>: path for saving trained model</li><li><code>gpu_id = 0</code>: use specified GPU</li><li><code>niter_per_epoch = 100</code>: number of iterations in each epoch</li><li><code>disable_tqdm = false</code>: set <code>true</code> when generating documentation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/boot.jl#L914-L932">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.train_Gyλ-Tuple{AbstractVector, AbstractMatrix, AbstractMatrix, String}" href="#MonotoneSplines.train_Gyλ-Tuple{AbstractVector, AbstractMatrix, AbstractMatrix, String}"><code>MonotoneSplines.train_Gyλ</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">train_Gyλ(rawy::AbstractVector, rawB::AbstractMatrix, rawL::AbstractMatrix, model_file::String)</code></pre><p>Train MLP generator G(y, λ) for λ ∈ [λl, λu] and y ~ N(f, σ²)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/boot.jl#L444-L448">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MonotoneSplines.train_Gλ-Tuple{AbstractVector, AbstractMatrix, AbstractMatrix}" href="#MonotoneSplines.train_Gλ-Tuple{AbstractVector, AbstractMatrix, AbstractMatrix}"><code>MonotoneSplines.train_Gλ</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">train_Gλ(rawy::AbstractVector, rawB::AbstractMatrix, rawL::AbstractMatrix; λl, λu)</code></pre><p>Train MLP generator G(λ) for λ ∈ [λl, λu].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/szcf-weiya/MonotoneSplines.jl/blob/db0a5b9d01350cb54fcb5ba61578618a4a2ac035/src/boot.jl#L370-L374">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/diff_sort/">« Differentiable Sort</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 4 January 2023 04:36">Wednesday 4 January 2023</span>. Using Julia version 1.8.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
